#!/bin/bash

## subs
usage(){
cat <<EOF
Usage
  # FASTA
  cat A.fa [B.fa ..] | seq-shuf > AB-shuf.fa
  # FASTQ
  cat A.fq [B.fq ..] | seq-shuf > AB-shuf.fq
  # FASTQ paired end
  interleave A_[12].fq .. | seq-shuf -pe | interleaved-split 1> A-shuf_1.fq 2> A-shuf_2.fq
EOF
exit 0;
}

check_bin(){
    hash $1 || { echo "$1 required in PATH" >&2; exit 1;}
}

## prep
[[ $1 =~ ^-h ]] && usage;

check_bin sort;
check_bin sed;

C=`head -c 1`; # read first char for format guessing

# FASTQ
if [[ $C == "@" ]]; then
    REC="1~4"; # 4 lines from fq
    [[ $1 =~ ^-p ]] && REC="1~8" # 8 lines from fq
    (echo -n $C; cat <&0) | sed "$REC{s/^/\x0/}" | sort -zR | tr -d '\0';
fi;

# FASTA
if [[ $C == ">" ]]; then
    (echo -n $C; cat <&0) | sed "s/^>/\x0>/" | sort -zR | tr -d '\0';
fi;

